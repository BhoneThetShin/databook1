<!DOCTYPE html>
<html lang="my">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Index - Myanmar Search System</title>
<style>
    body { margin: 0; font-family: sans-serif; display: flex; flex-direction: column; height: 100vh; background-color: #ffffff; }
    .toolbar { background-color: #9E9E9E; height: 56px; display: flex; align-items: center; padding: 0 15px; color: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .back-btn { font-size: 24px; margin-right: 20px; cursor: pointer; }
    .title { font-size: 19px; font-weight: 500; }
    .content-area { flex: 1; overflow-y: auto; padding: 15px; }
    #list-container { list-style: none; padding: 0; margin: 0; display: none; }
    .list-item { padding: 10px 3px; border-bottom: 1px solid #e0e0e0; font-size: 18px; cursor: pointer; color: #333; }
    #card-container { display: none; }
    .card { background: white; border-radius: 4px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border: 1px solid #eeeeee; cursor: pointer; }
    .card-header { color: #d81b60; text-align: right; font-size: 16px; margin-bottom: 10px; border-bottom: 1px solid #f5f5f5; padding-bottom: 5px; }
    .card-body { line-height: 1.8; color: #444; font-size: 16px; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; text-overflow: ellipsis; }
    .highlight { background-color: #d81b60; color: white; padding: 1px 4px; border-radius: 2px; }
    .bottom-nav { padding: 12px; background: white; border-top: 1px solid #eee; }
    .search-wrapper { background-color: #f1f3f4; border-radius: 30px; display: flex; align-items: center; padding: 0 15px; border: 1px solid #e0e0e0; }
    .search-wrapper input { border: none; background: transparent; outline: none; flex: 1; padding: 12px; font-size: 16px; }
</style>
</head>
<body>

<div class="toolbar">
    <div class="back-btn" onclick="goBack()">‚á±</div>
    <div class="title" id="toolbar-title">·ÄÖ·Ä¨·Äõ·Äæ·Ä¨·Äô·Äæ·ÄØ</div>
</div>

<div class="content-area">
    <ul id="list-container"></ul>
    <div id="card-container"></div>
</div>

<div class="bottom-nav" id="bottom-bar">
    <div class="search-wrapper">
        <span style="color:#757575">üîç</span>
        <input type="text" id="search-input" placeholder="·ÄÖ·Ä¨·Äõ·Ä≠·ÄØ·ÄÄ·Ä∫·Äï·Ä´..." onkeyup="handleSearch()">
        <span style="cursor:pointer; color:#757575" onclick="clearInput()">‚úï</span>
    </div>
</div>

<script src="Books.js"></script>

<script>
const myanDigits = ['·ÅÄ', '·ÅÅ', '·ÅÇ', '·ÅÉ', '·ÅÑ', '·ÅÖ', '·ÅÜ', '·Åá', '·Åà', '·Åâ'];
function toMyanNum(n) { return n.toString().split('').map(d => myanDigits[d] || d).join(''); }

// ·ÅÅ·Åã Keyword List Render ·Äú·ÄØ·Äï·Ä∫·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏
function initList() {
    const listContainer = document.getElementById('list-container');
    if (typeof combinedKeywords !== 'undefined') {
        listContainer.innerHTML = combinedKeywords.map(word => 
            `<li class="list-item" onclick="openCard('${word}')">${word}</li>`
        ).join('');
    }
}

function handleSearch() {
    const input = document.getElementById('search-input').value.trim();
    const list = document.getElementById('list-container');
    if (input.length > 0) {
        list.style.display = "block";
        document.getElementById('card-container').style.display = "none";
        Array.from(list.children).forEach(item => {
            item.style.display = item.innerText.includes(input) ? "block" : "none";
        });
    } else { 
        list.style.display = "none"; 
    }
}

// ·ÅÇ·Åã Card View (Keyword ·Äê·Ä≠·ÄØ·ÄÄ·Ä∫·Äõ·Ä≠·ÄØ·ÄÄ·Ä∫·Äê·Ä∞·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏ ·Äû·Ä≠·ÄØ·Ä∑·Äô·Äü·ÄØ·Äê·Ä∫ Text ·Äë·Ä≤·Äô·Äæ·Ä¨·Äï·Ä´·Äî·Ä±·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏·ÄÄ·Ä≠·ÄØ ·Äõ·Äæ·Ä¨·Äô·Ää·Ä∫)
function openCard(word) {
    document.getElementById('list-container').style.display = "none";
    document.getElementById('bottom-bar').style.display = "none";
    const cardBox = document.getElementById('card-container');
    cardBox.style.display = "block";

    let totalMatches = 0;
    
    // Books.js ·Äë·Ä≤·Äõ·Äæ·Ä≠ ·ÄÖ·Ä¨·Ä°·ÄØ·Äï·Ä∫·Ä°·Ä¨·Ä∏·Äú·ÄØ·Ä∂·Ä∏·Äï·Ä±·Ä´·ÄÑ·Ä∫·Ä∏ (combinedData) ·Äë·Ä≤·Äê·ÄΩ·ÄÑ·Ä∫ ·Äõ·Äæ·Ä¨·Äñ·ÄΩ·Ä±·ÄÅ·Äº·ÄÑ·Ä∫·Ä∏
    const filteredResults = combinedData.filter(item => 
        item.keyword === word || item.text.includes(word)
    );

    cardBox.innerHTML = filteredResults.map(item => {
        const regex = new RegExp(word, 'g');
        const matches = item.text.match(regex);
        if (matches) totalMatches += matches.length;

        return `
            <div class="card" onclick="location.href='sketchware://goto?page=${item.file}&search=${encodeURIComponent(word)}'">
                <div class="card-header">${item.title}</div>
                <div class="card-body">
                    ${item.text.replace(regex, `<span class="highlight">${word}</span>`)}
                </div>
            </div>
        `;
    }).join('');

    document.getElementById('toolbar-title').innerText = `·Äê·ÄΩ·Ä±·Ä∑·Äõ·Äæ·Ä≠·Äô·Äæ·ÄØ - ${toMyanNum(totalMatches)} ·ÄÄ·Äº·Ä≠·Äô·Ä∫`;
}

function goBack() {
    document.getElementById('card-container').style.display = "none";
    document.getElementById('bottom-bar').style.display = "block";
    document.getElementById('toolbar-title').innerText = "·ÄÖ·Ä¨·Äõ·Äæ·Ä¨·Äô·Äæ·ÄØ";
    document.getElementById('list-container').style.display = "none";
}

function clearInput() { document.getElementById('search-input').value = ""; handleSearch(); }

window.onpopstate = function() {
    if (document.getElementById('card-container').style.display === "block") {
        goBack();
        history.pushState(null, null, window.location.pathname);
    }
};

history.pushState(null, null, window.location.pathname);
initList();
</script>
</body>
</html>

